# Wazuh Implementation

Version: 4.12.0 
Date: July 03, 2025
Prepared By: Ronald James

# 1. Executive Summary
This document outlines the implementation of the Wazuh Security Information and Event Management (SIEM) and Extended Detection and Response (XDR) platform within our organization. The report details the project objectives, the key features implemented, an explanation of these features, and a high-level overview of the setup process. The goal of this implementation is to enhance the organization's security posture by providing real-time threat detection, incident response capabilities, continuous monitoring, and compliance auditing.
# 2. Objectives of Wazuh Implementation
The primary objectives for implementing Wazuh are:
Real-time Threat Detection and Alerting: To gain immediate visibility into potential security incidents, malicious activities, and unauthorized access attempts across the IT infrastructure. This includes detecting malware, rootkits, intrusions, and suspicious anomalies.
Centralized Log Management and Analysis: To collect, aggregate, store, and analyze security logs from various sources (servers, endpoints, network devices, applications, cloud environments) in a centralized location for comprehensive monitoring and forensic analysis.
File Integrity Monitoring (FIM): To monitor critical system and application files for unauthorized modifications, deletions, or creations, ensuring data integrity and compliance.
Security Configuration Assessment (SCA): To continuously assess the configuration of systems against predefined security policies, hardening guides (e.g., CIS Benchmarks), and regulatory standards, identifying misconfigurations and vulnerabilities.
Vulnerability Detection and Management: To identify known vulnerabilities in installed software and operating systems by correlating software inventory data with continuously updated Common Vulnerabilities and Exposures (CVE) databases.
Incident Response Capabilities: To enable automated and manual active responses to detected threats, such as blocking malicious IPs, isolating compromised systems, or running forensic commands.
Regulatory Compliance: To assist in meeting various industry and regulatory compliance requirements (e.g., PCI DSS, HIPAA, GDPR, NIST, ISO 27001) by providing necessary security controls, auditing capabilities, and reporting.
Improved IT Hygiene: To gain better visibility into asset inventory, installed software, open ports, and running processes to optimize security posture and maintain good IT hygiene.
Scalability and Flexibility: To deploy a security solution that can scale horizontally to accommodate a growing number of monitored endpoints and diverse IT environments, including on-premises, virtualized, containerized, and cloud platforms.

# 3. Wazuh Feature Content and Explanation
Wazuh is an open-source security platform that unifies XDR and SIEM capabilities. Its comprehensive feature set is built upon a modular architecture.

# 3.1. Core Components
Wazuh's architecture typically consists of the following central components:
Wazuh Agent:


Explanation: Lightweight software installed on endpoints (laptops, desktops, servers, cloud instances, virtual machines). It collects security data, monitors system activity, performs integrity checks, and communicates securely with the Wazuh Manager. Agents are available for various operating systems (Linux, Windows, macOS, Solaris, AIX, HP-UX).
Functionality: Collects logs, performs FIM, SCA, rootkit detection, vulnerability detection, and allows for active response actions.
Wazuh Server (Manager):


Explanation: The central brain of the Wazuh deployment. It receives, processes, analyzes, and stores security data from the agents. It uses decoders and rules to identify security events and generate alerts based on threat intelligence. It also manages agents remotely (configuration, upgrades). In a single-node setup, it co-exists with the Indexer and Dashboard.
Functionality: Log analysis, rule-based alerting, agent management, active response orchestration, threat intelligence correlation.
Wazuh Indexer:


Explanation: A highly scalable, full-text search and analytics engine (based on OpenSearch or Elasticsearch in older versions). It indexes and stores the alerts and events generated by the Wazuh Manager. This allows for fast querying, analysis, and visualization of security data. In a single-node setup, it runs on the same machine as the Manager and Dashboard.
Functionality: Data storage, indexing, search capabilities for security events and alerts.
Wazuh Dashboard:


Explanation: The web user interface for data visualization and analysis (based on OpenSearch Dashboards or Kibana in older versions). It provides pre-built dashboards, reports, and tools for threat hunting, compliance auditing, incident investigation, and overall security posture monitoring. In a single-node setup, it runs on the same machine as the Manager and Indexer.
Functionality: Real-time dashboards, alert visualization, historical data analysis, compliance reporting, configuration management.

# 3.2. Key Features and Capabilities
Log Data Analysis:


Explanation: Wazuh agents collect diverse log data (system logs, application logs, security event logs, cloud logs) from monitored endpoints. The Wazuh Manager then parses, decodes, and analyzes this data against a comprehensive set of rules. This allows for the detection of anomalies, errors, malicious activities, policy violations, and other security-relevant events.
Benefits: Centralized visibility, rapid identification of security incidents, comprehensive audit trails.
Intrusion Detection (Host-based and Network-based):


Explanation: Wazuh acts as a Host-based Intrusion Detection System (HIDS) by monitoring system calls, processes, file access, and network connections on endpoints. It can also integrate with network devices (via Syslog) to perform Network-based Intrusion Detection (NIDS) by analyzing network traffic logs for known attack signatures or suspicious patterns.
Benefits: Early detection of unauthorized access, malware infections, and suspicious activities.
File Integrity Monitoring (FIM):


Explanation: The FIM module continuously monitors specified files and directories for changes in their content, permissions, ownership, and attributes. Any unauthorized modification to critical system files, configuration files, or sensitive data triggers an alert.
Benefits: Detects tampering, rootkit installations, data exfiltration attempts, and aids in compliance (e.g., PCI DSS).
Security Configuration Assessment (SCA):


Explanation: Wazuh agents periodically scan system configurations against pre-defined policies (e.g., CIS benchmarks, custom hardening guides). It identifies misconfigurations, insecure settings, and non-compliant configurations, providing recommendations for remediation.
Benefits: Ensures systems adhere to security best practices, reduces attack surface, supports regulatory compliance.
Vulnerability Detection:


Explanation: Wazuh agents collect software inventory data from endpoints. The Wazuh Manager then correlates this inventory with constantly updated CVE (Common Vulnerabilities and Exposures) databases to identify installed software with known vulnerabilities.
Benefits: Proactive identification of vulnerable software, helps prioritize patching efforts, reduces risk of exploitation.
Incident Response (Active Response):


Explanation: Wazuh provides "Active Response" capabilities, which are automated actions triggered by specific alerts. These actions can include blocking malicious IP addresses, isolating compromised systems, executing custom scripts for remediation, or collecting additional forensic data.
Benefits: Automated threat containment, reduced response time, minimizes impact of security incidents.
Regulatory Compliance:


Explanation: Wazuh offers built-in capabilities and out-of-the-box dashboards that assist organizations in demonstrating compliance with various industry standards and regulations such as PCI DSS, HIPAA, GDPR, NIST 800-53, and others. Its features like FIM, SCA, log retention, and reporting directly contribute to compliance requirements.
Benefits: Streamlines compliance auditing, provides necessary evidence for regulatory requirements.
Cloud Security Monitoring:


Explanation: Wazuh integrates with major cloud providers (AWS, Azure, Google Cloud) to pull security data directly from their APIs. It monitors cloud infrastructure at both API and instance levels, detecting misconfigurations, suspicious activities, and compliance issues within cloud environments.
Benefits: Extends security visibility into cloud workloads, ensures cloud security posture management.
Container Security:


Explanation: Wazuh provides runtime security for containerized environments (Docker, Kubernetes). The agent can run on the Docker host, integrating with the Docker engine API and Kubernetes API to monitor container behavior, detect threats, vulnerabilities, and anomalies within containers.
Benefits: Secures modern containerized applications, identifies risks in dynamic container environments.

# 4. How to Set Up Wazuh (High-Level Overview - Single-Node Setup)
Setting up Wazuh in a single-node configuration involves deploying all the central components (Manager, Indexer, Dashboard) on a single machine, and then deploying agents on the monitored endpoints. This setup is ideal for smaller environments or initial evaluations due to its simplicity.

# 4.1. Installation Steps (Assisted or Step-by-Step for Single-Node):
Wazuh provides flexible installation options. For a single-node setup, the Assisted Installation script is often the quickest and most straightforward method. Alternatively, you can follow the detailed Step-by-Step guide for more granular control.
This script will:
Automatically generate the necessary SSL certificates.
Install the Wazuh Indexer.
Install the Wazuh Manager.
Install Filebeat (to forward alerts from Manager to Indexer).
Install the Wazuh Dashboard.
Configure all components to work together on a single machine.
Provide you with the default admin credentials for the Wazuh Dashboard.

<pre lang="bash"><code> ```bash curl -sO https://packages.wazuh.com/4.12/wazuh-install.sh sudo bash ./wazuh-install.sh --all-in-one cd Wazuh-SIEM-XDR-Automation-Hardening/ cp template/authd.pass /var/ossec/etc/ ``` </code></pre>

# 4.2. Wazuh Agent Installation : 
       
We have automated the Wazuh agent installation using Ansible. This Ansible playbook checks the server IP and categorizes it into either the production or staging group. It supports installing the Wazuh agent on both Ubuntu and CentOS systems. 

The Ansible playbook copies and applies our customized OSSEC configuration, which includes optimized features and Suricata integration.

After the agent installation, the Wazuh agent will only connect to the Wazuh server if it has a valid authorization key in its ossec/etc/ folder.

# 4.3. Suricata IDS Installation in Wazuh Agent Servers : 

Installs and configures Suricata, an open-source intrusion detection system (IDS), on servers where the Wazuh agent is deployed. Suricata monitors network traffic and generates alerts for suspicious activity, which are then forwarded to the Wazuh manager for centralized analysis and correlation.
Key Features:
Installs Suricata with the latest supported ruleset.


Configures Suricata to log events in JSON format for Wazuh compatibility.


Enables automatic log forwarding to the Wazuh agent for real-time analysis.


Supports both Ubuntu and CentOS-based systems.


Use Case:
 Enhances host-level security monitoring by combining Suricata’s deep packet inspection with Wazuh’s log analysis and alerting capabilities.

We have created a script to install and configure Suricata IDS based on OS. The script ensures Suricata is configured with the correct network interface, IP range (HOME_NET), and metadata enrichment (community-id), enabling accurate traffic analysis, efficient alerting, and seamless integration with Wazuh.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   


